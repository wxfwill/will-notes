(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{439:function(t,s,v){"use strict";v.r(s);var _=v(54),a=Object(_.a)({},(function(){var t=this,s=t.$createElement,v=t._self._c||s;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"_4-事件循环"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_4-事件循环"}},[t._v("#")]),t._v(" 4.事件循环")]),t._v(" "),v("p",[v("strong",[t._v("事件循环 Event-Loop 是理解 js 单线程工作重要的一部分")])]),t._v(" "),v("h2",{attrs:{id:"event-loop-流程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#event-loop-流程"}},[t._v("#")]),t._v(" Event Loop 流程")]),t._v(" "),v("ol",[v("li",[t._v("从宏任务队列中，按照入队顺序，找到第一个执行的宏任务，放入调用栈，开始执行；")]),t._v(" "),v("li",[t._v("执行该宏任务下所有的同步任务后，即执行栈清空后，该宏任务出队，然后微任务队列开始按照入队顺序，依次执行微任务，"),v("code",[t._v("直至微任务队列清空为止")]),t._v("；")]),t._v(" "),v("li",[t._v("当微任务队列清空后，一个事件循环结束；")]),t._v(" "),v("li",[t._v("执行浏览器 UI 渲染线程的渲染工作")]),t._v(" "),v("li",[t._v("执行完本轮的宏任务后，开始第二次事件循环，回到 2，直到宏任务队列清空为止。")])]),t._v(" "),v("p",[v("code",[t._v("注意：")])]),t._v(" "),v("ul",[v("li",[t._v("当我们第一次执行代码时，解析器会将整体代码"),v("code",[t._v("script")]),t._v("放入宏任务队列，因此事件循环是从第一个宏任务开始；")]),t._v(" "),v("li",[t._v("在本轮宏任务完成前遇到新的宏任务时，将新的宏任务推到宏任务队列，接着执行本轮宏任务之后代码；本轮宏任务及微任务结束后（完成了一次 event loop 后），再开始执行下一个宏任务；")]),t._v(" "),v("li",[t._v("如果在执行微任务过程中，产生新的微任务添加到微任务队列中，也需要一起清空；微任务队列没清空之前，是不会执行下一个宏任务的")])]),t._v(" "),v("h2",{attrs:{id:"页面渲染"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#页面渲染"}},[t._v("#")]),t._v(" 页面渲染")]),t._v(" "),v("blockquote",[v("p",[t._v("每当一次事件循环结束后，即一个宏任务执行完成以后以及微任务队列被清空后，浏览器就会进行一次页面更新渲染。")])]),t._v(" "),v("p",[t._v("通常我们浏览器页面刷新频率是 60fps,也就是意味着 16.67ms 要刷新一次，")]),t._v(" "),v("div",{staticClass:"custom-block tip"},[v("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),v("p",[t._v("刷新频率: FPS 表示的是每秒钟画面更新次数(60fps 即：1000ms/60);")]),t._v(" "),v("p",[t._v("也就是说，浏览器对每一帧画面的渲染工作需要在 16ms(1000ms/60)之内完成，即每一次渲染都要在 16m 完成才不会掉帧；")]),t._v(" "),v("p",[t._v("举例：如果某一次渲染花了 20ms,那么它的渲染效果不会在第一帧 16ms 的时候显示，这个渲染结果会在第一帧 32ms 的时候显示，这就掉了一帧。")]),t._v(" "),v("p",[v("a",{attrs:{href:"'https://zhuanlan.zhihu.com/p/78569750'"}},[t._v("参考前端性能优化--刷新率(FPS)")])])]),t._v(" "),v("h2",{attrs:{id:"参考文章"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[t._v("#")]),t._v(" 参考文章")]),t._v(" "),v("ul",[v("li",[v("a",{attrs:{href:"'https://juejin.cn/post/6969028296893792286#heading-10'"}},[t._v("做一些动图，学习一下 EventLoop")])]),t._v(" "),v("li",[v("a",{attrs:{href:"'https://juejin.cn/post/6844904077537574919#heading-16'"}},[t._v("要就来 45 道 Promise 面试题一次爽到底")])])])])}),[],!1,null,null,null);s.default=a.exports}}]);